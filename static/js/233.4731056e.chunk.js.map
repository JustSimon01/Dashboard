{"version":3,"file":"static/js/233.4731056e.chunk.js","mappings":"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","sources":["views/app-views/main/draganddrop/Draggable.js","views/app-views/main/draganddrop/Droppable.js","views/app-views/main/draganddrop/index.js","utils/helpers/jsonDownload.js"],"sourcesContent":["import React from \"react\";\r\nimport { useDrag } from \"react-dnd\";\r\nimport vaseImg from 'assets/png/vase.png';\r\nimport tableImg from 'assets/png/table.png';\r\nimport chairImg from 'assets/png/chair.png';\r\n\r\nconst Draggable = ({ data }) => {\r\n  const { _id, id, type, x, y } = data;\r\n  const [{ isDragging }, dragRef] = useDrag({\r\n    type: \"box\",\r\n    item: { _id, id, type, x, y },\r\n    collect: (monitor) => ({\r\n      isDragging: monitor.isDragging(),\r\n      clientOffset: monitor.getClientOffset()\r\n    })\r\n  });\r\n\r\n  const getImageByType = (type) => {\r\n    switch (type) {\r\n      case 'VASE':\r\n        return vaseImg;\r\n      case 'TABLE':\r\n        return tableImg;\r\n      case 'CHAIR':\r\n        return chairImg;\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  const blockSideLength = 50;\r\n\r\n  const gridStyle = {\r\n    width: blockSideLength,\r\n    height: blockSideLength,\r\n    cursor: 'grab',\r\n    opacity: isDragging ? 0.5 : 1\r\n  };\r\n\r\n  const dropStyle = {\r\n    width: blockSideLength,\r\n    height: blockSideLength,\r\n    position: 'absolute',\r\n    top: y - blockSideLength / 2,\r\n    left: x - blockSideLength / 2,\r\n    cursor: 'move',\r\n    opacity: isDragging ? 0.5 : 1\r\n  };\r\n\r\n  return (\r\n    !x\r\n      ? <img src={getImageByType(type)} alt={type} ref={dragRef} style={gridStyle} />\r\n      : <img src={getImageByType(type)} alt={type} ref={dragRef} style={dropStyle} />\r\n  );\r\n};\r\n\r\nexport default Draggable;\r\n","import { Card, Space } from \"antd\";\r\nimport React, { useRef } from \"react\";\r\nimport { useDrop } from \"react-dnd\";\r\n\r\nconst Droppable = ({ children, onDrop }) => {\r\n  const dropTargetRef = useRef(null);\r\n  const [, dropTarget] = useDrop({\r\n    accept: \"box\",\r\n    drop(itemId, monitor) {\r\n      const currentClientOffset = monitor.getClientOffset();\r\n      let x = 0;\r\n      let y = 0;\r\n      if (currentClientOffset) {\r\n        const containerRect = dropTargetRef.current.getBoundingClientRect();\r\n        const deltaX = Math.round(currentClientOffset.x - containerRect.left);\r\n        const deltaY = Math.round(currentClientOffset.y - containerRect.top);\r\n        x = deltaX;\r\n        y = deltaY;\r\n      }\r\n      onDrop({ ...itemId, x: x, y: y });\r\n    }\r\n  });\r\n\r\n  const dropContainer = {\r\n    width: '600px',\r\n    height: '500px',\r\n    position: \"relative\"\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Card ref={dropTarget(dropTargetRef)} style={dropContainer}>\r\n        {children}\r\n      </Card>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Droppable;\r\n","import React, { useEffect } from 'react';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport { Card, Table, Tag, Tooltip, message, Upload, Button, Space } from 'antd';\r\nimport { DndProvider } from 'react-dnd';\r\nimport { HTML5Backend } from 'react-dnd-html5-backend';\r\nimport Draggable from './Draggable';\r\nimport Droppable from './Droppable';\r\nimport handleDownload from 'utils/helpers/jsonDownload';\r\nimport items from 'assets/data/items.data.json'\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { clearItems, setItems } from 'store/slices/itemsSlice';\r\n\r\nconst dropContainer = {\r\n  width: '600px',\r\n  height: '500px',\r\n};\r\n\r\nconst itemsContainer = {\r\n  width: '600px',\r\n  overflowX: 'scroll',\r\n  whiteSpace: 'nowrap',\r\n};\r\n\r\nexport const DragAndDropContainer = () => {\r\n  const [dragableElements, setdragableElements] = React.useState(items);\r\n  const dispatch = useDispatch();\r\n  const itemsArray = useSelector((state) => state.items);\r\n\r\n  const handleDrop = (itemId) => {\r\n    const updatedItemId = { ...itemId, _id: uuidv4() };\r\n    const updatedElements = itemsArray.filter((element) => element._id !== itemId._id);\r\n    dispatch(setItems([...updatedElements, updatedItemId]));\r\n  };\r\n\r\n  const customRequest = ({ file, onSuccess }) => {\r\n    onSuccess('ok');\r\n  };\r\n\r\n  const clearElements = () => {\r\n    dispatch(clearItems([]));\r\n  };\r\n\r\n  function handleUpload(file) {\r\n    let fileObj = file.originFileObj\r\n    if (fileObj) {\r\n      const reader = new FileReader();\r\n      reader.onload = (event) => {\r\n        const jsonData = JSON.parse(event.target.result);\r\n        dispatch(setItems(jsonData));\r\n      };\r\n      const blob = new Blob([fileObj], { type: fileObj.type });\r\n      reader.readAsText(blob);\r\n    }\r\n  };\r\n\r\n  const handleFileDownload = () => {\r\n    handleDownload(itemsArray);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <DndProvider backend={HTML5Backend}>\r\n        <Space>\r\n          <Card style={itemsContainer} title=\"Объекты\">\r\n            <Space>\r\n              {dragableElements.map((item) => <Draggable key={uuidv4()} data={item} />)}\r\n            </Space>\r\n          </Card>\r\n\r\n          <Space direction=\"vertical\">\r\n            <Upload showUploadList={false} customRequest={customRequest} onChange={(info) => {\r\n              const { file } = info;\r\n              handleUpload(file);\r\n            }}>\r\n              <Button type=\"primary\">Загрузить схему</Button>\r\n            </Upload>\r\n\r\n            <Button type=\"primary\" onClick={handleFileDownload}>Выгрузить схему</Button>\r\n            <Button type=\"primary\" onClick={clearElements}>Очистить схему</Button>\r\n          </Space>\r\n\r\n        </Space>\r\n\r\n        <Droppable style={dropContainer} onDrop={handleDrop}>\r\n          {itemsArray && itemsArray.map((item) => { return <Draggable key={uuidv4()} data={item} /> })}\r\n        </Droppable>\r\n      </DndProvider>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DragAndDropContainer;\r\n","export default function handleDownload(elements) {\r\n  const jsonData = JSON.stringify(elements, null, 2)\r\n  const blob = new Blob([jsonData], { type: 'application/json' })\r\n  const url = URL.createObjectURL(blob)\r\n  const link = document.createElement('a')\r\n  link.href = url\r\n  link.download = 'schema.json'\r\n  link.click()\r\n  URL.revokeObjectURL(url)\r\n};\r\n\r\n"],"names":["data","_id","id","type","x","y","useDrag","item","collect","monitor","isDragging","clientOffset","getClientOffset","dragRef","getImageByType","blockSideLength","gridStyle","width","height","cursor","opacity","dropStyle","position","top","left","src","alt","ref","style","children","onDrop","dropTargetRef","useRef","useDrop","accept","drop","itemId","currentClientOffset","containerRect","current","getBoundingClientRect","Math","round","dropTarget","dropContainer","itemsContainer","overflowX","whiteSpace","DragAndDropContainer","React","items","dragableElements","dispatch","useDispatch","itemsArray","useSelector","state","DndProvider","backend","HTML5Backend","title","map","uuidv4","direction","showUploadList","customRequest","file","onSuccess","onChange","info","fileObj","originFileObj","reader","FileReader","onload","event","jsonData","JSON","parse","target","result","setItems","blob","Blob","readAsText","handleUpload","onClick","elements","stringify","url","URL","createObjectURL","link","document","createElement","href","download","click","revokeObjectURL","handleDownload","clearItems","updatedItemId","updatedElements","filter","element"],"sourceRoot":""}